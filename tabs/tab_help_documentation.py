import streamlit as st
from pathlib import Path

def render_help_documentation_tab(session_id):
    """Render the help documentation tab."""
    # Handle None session_id (user not logged in)
    if session_id is None:
        st.warning("è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚")
        return
    
    
    
    # Create two columns: sidebar navigation and main content
    col1, col2 = st.columns([1, 3])

    # Define section mappings (label -> key)
    section_mappings = {
        "ğŸ“ æ–‡ä»¶é½å¥—æ€§æ£€æŸ¥": "file_completeness_check",
        "ğŸ” ç‰¹æ®Šç‰¹æ€§ç¬¦å·æ£€æŸ¥": "special_symbols_check",
        "ğŸ“Š è®¾è®¡åˆ¶ç¨‹æ£€æŸ¥": "parameters_check",
        "âœ… æ–‡ä»¶è¦ç´ æ£€æŸ¥": "file_elements_check",
        "ğŸ¢ ä¼ä¸šæ ‡å‡†æ£€æŸ¥": "enterprise_standard_check",
        "ğŸ“‹ å†å²é—®é¢˜è§„é¿": "history_issues_avoidance",
        "ğŸ¤– AIæ™ºèƒ½ä½“": "ai_agent",
        "âš™ï¸ è®¾ç½®": "settings",
        "â“ å¸¸è§é—®é¢˜": "faq",
        "ğŸ“š æŠ€æœ¯æ–‡æ¡£": "technical_docs",
    }

    with col1:
        # Minimal nav styling to resemble docs sidebar
        st.markdown(
            """
            <style>
            .help-nav a, .help-nav button {
                width: 100%;
                text-align: left;
            }
            .help-nav .nav-item {
                padding: 6px 8px;
                margin: 2px 0;
                border-radius: 6px;
            }
            </style>
            """,
            unsafe_allow_html=True,
        )

        st.markdown("### ç›®å½•")

        # Current selected section in session_state (default to ğŸ“ æ–‡ä»¶é½å¥—æ€§æ£€æŸ¥)
        selected_section = st.session_state.get(
            f"help_section_active_{session_id}", "ğŸ“ æ–‡ä»¶é½å¥—æ€§æ£€æŸ¥"
        )
        # Backward compatibility: if an old value without icon is stored, reset to default
        valid_labels = set(section_mappings.keys())
        if selected_section not in valid_labels:
            selected_section = "ğŸ“ æ–‡ä»¶é½å¥—æ€§æ£€æŸ¥"
            st.session_state[f"help_section_active_{session_id}"] = selected_section

        # Render a vertical list of buttons
        for label, key_name in section_mappings.items():
            is_active = (label == selected_section)
            button_label = f"{label}"
            if st.button(
                button_label,
                key=f"help_nav_{key_name}_{session_id}",
                type="primary" if is_active else "secondary",
                use_container_width=True,
            ):
                st.session_state[f"help_section_active_{session_id}"] = label
                st.rerun()

    with col2:
        # Display content based on selection
        if selected_section == "ğŸ“ æ–‡ä»¶é½å¥—æ€§æ£€æŸ¥":
            render_file_completeness_check_section()
        elif selected_section == "ğŸ” ç‰¹æ®Šç‰¹æ€§ç¬¦å·æ£€æŸ¥":
            render_special_symbols_check_section()
        elif selected_section == "ğŸ“Š è®¾è®¡åˆ¶ç¨‹æ£€æŸ¥":
            render_parameters_check_section()
        elif selected_section == "âœ… æ–‡ä»¶è¦ç´ æ£€æŸ¥":
            render_file_elements_check_section()
        elif selected_section == "ğŸ“‹ å†å²é—®é¢˜è§„é¿":
            render_history_issues_avoidance_section()
        elif selected_section == "ğŸ¤– AIæ™ºèƒ½ä½“":
            render_ai_agent_section()
        elif selected_section == "âš™ï¸ è®¾ç½®":
            render_settings_section()
        elif selected_section == "â“ å¸¸è§é—®é¢˜":
            render_faq_section()
        elif selected_section == "ğŸ“š æŠ€æœ¯æ–‡æ¡£":
            render_technical_docs_section(session_id)

def render_special_symbols_check_section():
    """Render the special symbols check section."""
    st.header("ğŸ” ç‰¹æ®Šç‰¹æ€§ç¬¦å·æ£€æŸ¥")
    
    st.markdown("""
    ç‰¹æ®Šç‰¹æ€§ç¬¦å·æ£€æŸ¥åŠŸèƒ½ç”¨äºè¯†åˆ«å’ŒéªŒè¯æ§åˆ¶è®¡åˆ’ï¼ˆControl Planï¼‰ä¸­çš„ç‰¹æ®Šç‰¹æ€§ç¬¦å·ï¼ˆâ˜…ã€â˜†ã€/ï¼‰ï¼Œç¡®ä¿å…¶ä½¿ç”¨ç¬¦åˆæ ‡å‡†è§„èŒƒã€‚
    
    ### ä½¿ç”¨æµç¨‹

    1. ç™»å½•å¹¶è¿›å…¥æœ¬åŠŸèƒ½é¡µï¼Œç¡®è®¤å½“å‰ç”¨æˆ·ä¼šè¯ã€‚
    2. ä¸Šä¼ æ–‡ä»¶ï¼š
       - æ§åˆ¶è®¡åˆ’æ–‡ä»¶ï¼ˆå¿…é€‰ï¼‰
       - å¾…æ£€æŸ¥æ–‡ä»¶ï¼ˆç›®æ ‡æ–‡ä»¶ï¼Œå¿…é€‰ï¼‰
       - å›¾çº¸æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
    3. è¿è¡Œæ–¹å¼ï¼š
       - è‹¥å³ä¾§å·²åˆ—å‡ºå†å²æ–‡ä»¶ï¼Œè¯·å…ˆç‚¹å‡»ã€æ¸…ç©ºæ‰€æœ‰æ–‡ä»¶ã€‘æŒ‰é’®ï¼Œç¡®ä¿ä»¥ç©ºç™½ç¯å¢ƒå¼€å§‹ã€‚
       - æŒ‰ä¸‹ã€å¼€å§‹ã€‘ï¼šç³»ç»Ÿä¼šæ ¡éªŒå·²ä¸Šä¼ æ–‡ä»¶å¹¶æ¸…ç†æ—§ç»“æœï¼Œç„¶åç›´æ¥å¯¹â€œæ‚¨ä¸Šä¼ çš„æ–‡ä»¶â€æ‰§è¡Œåˆ†ææµç¨‹ã€‚
       - æŒ‰ä¸‹ã€æ¼”ç¤ºã€‘ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨æ‹·è´ä¸€å¥—ç¤ºä¾‹æ–‡ä»¶åˆ°æ‚¨çš„ä¼šè¯ç›®å½•ï¼Œå¹¶ç«‹å³è¿è¡ŒåŒæ ·çš„åˆ†ææµç¨‹ï¼Œä¾¿äºå¿«é€Ÿä¸Šæ‰‹ä½“éªŒã€‚
    4. ç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œä¸‰æ­¥åˆ†æï¼ˆç”¨è¯­å‹å¥½ç‰ˆï¼‰ï¼š
       - ç¬¬ä¸€æ­¥ï¼šAI åŠ©æ‰‹è¯»å–å¹¶ç†è§£æ‚¨ä¸Šä¼ çš„æ–‡æ¡£å†…å®¹ï¼Œä»æ¯ä¸ª Excel å·¥ä½œè¡¨ä¸­æå–ä¸â€œç‰¹æ®Šç‰¹æ€§ç¬¦å·ï¼ˆ/ã€â˜…ã€â˜†ï¼‰â€ç›¸å…³çš„ä¿¡æ¯ï¼Œå½¢æˆâ€œé˜¶æ®µæ€§ç»“æœâ€ï¼›æ¯ä¸ªâ€œé˜¶æ®µæ€§ç»“æœâ€å¯¹åº”ä¸€ä¸ªå·¥ä½œè¡¨çš„æå–ä¸æ¯”å¯¹è¦ç‚¹ï¼Œä¾¿äºé€æ­¥æ ¸æŸ¥ã€‚
       - ç¬¬äºŒæ­¥ï¼šåœ¨é˜¶æ®µæ€§ç»“æœçš„åŸºç¡€ä¸Šï¼Œæ±‡æ€»å¾—åˆ°â€œç‰¹æ®Šç‰¹æ€§ç¬¦å·ä¸ä¸€è‡´ç»“è®ºâ€ï¼Œå¹¶åœ¨é¡µé¢å³ä¾§ä»¥æµå¼æ–¹å¼å±•ç¤ºï¼Œä¾¿äºæ‚¨å³æ—¶æŸ¥çœ‹ã€‚
       - ç¬¬ä¸‰æ­¥ï¼šè¿›ä¸€æ­¥æ•´ç† AI è¾“å‡ºï¼Œç”Ÿæˆå¯ä¸‹è½½çš„ Excel è¡¨æ ¼ï¼ˆé¡µé¢ä¼šç›´æ¥å±•ç¤ºé¢„è§ˆï¼‰ï¼Œæ–¹ä¾¿æ‚¨ç•™æ¡£ã€è¯„å®¡ä¸ä¼ é˜…ã€‚
    5. åœ¨é¡µé¢å³ä¾§æŸ¥çœ‹è¡¨æ ¼ä¸ä¸‹è½½çš„ Excelã€‚å¦‚éœ€é‡è·‘ï¼Œå¯ç‚¹å‡»ã€é‡æ–°å¼€å§‹ã€‘ã€‚
    
    æ³¨æ„ï¼š
    - æœ¬é¡µçš„ LLM è°ƒç”¨ä¸ºâ€œæ— è®°å¿†â€æ¨¡å¼ï¼Œæ¯æ¬¡è°ƒç”¨ç›¸äº’ç‹¬ç«‹ï¼›ä»… AI Agent é¡µä¿ç•™å¯¹è¯è®°å¿†ã€‚
    - è‹¥å¯¼å‡ºçš„ Excel ä¸­â€œç›®æ ‡æ–‡ä»¶/æ§åˆ¶è®¡åˆ’æ–‡ä»¶â€åˆ—ä¸ºç©ºï¼Œé€šå¸¸è¡¨ç¤ºç»“è®ºæ–‡æœ¬æœªåŒ…å«æ¥æºä¿¡æ¯ã€‚å¯é€šè¿‡é‡æ–°ç”Ÿæˆâ€œç»“è®ºâ€æ­¥éª¤ï¼ˆé¡µé¢å·²å†…ç½®å¼ºçº¦æŸæç¤ºè¯ï¼‰æ¥è¡¥é½ã€‚

    ### ğŸ“ æ”¯æŒçš„æ–‡ä»¶ç±»å‹

    - æ§åˆ¶è®¡åˆ’æ–‡ä»¶ã€å¾…æ£€æŸ¥æ–‡ä»¶ï¼šExcelï¼ˆ.xlsx / .xlsï¼‰
    - å›¾çº¸æ–‡ä»¶ï¼šPDFï¼ˆ.pdfï¼‰
    
    å¦‚éœ€æ”¯æŒæ›´å¤šæ ¼å¼ï¼Œè¯·è”ç³»ï¼šå‘¨æ˜­å¤ã€‚
    """)

def render_parameters_check_section():
    """Render the parameters check section."""
    st.header("âš™ï¸ è®¾è®¡åˆ¶ç¨‹æ£€æŸ¥")
    
    st.markdown("""
    è®¾è®¡åˆ¶ç¨‹æ£€æŸ¥åŠŸèƒ½ç”¨äºéªŒè¯äº§å“è®¾è®¡å‚æ•°å’Œåˆ¶é€ å·¥è‰ºå‚æ•°çš„åˆç†æ€§ï¼Œç¡®ä¿è®¾è®¡åˆ°åˆ¶é€ çš„è½¬æ¢è¿‡ç¨‹ç¬¦åˆè´¨é‡è¦æ±‚ã€‚
    
    ### ä½¿ç”¨æµç¨‹
    
    1. ç™»å½•å¹¶è¿›å…¥æœ¬åŠŸèƒ½é¡µï¼Œç¡®è®¤å½“å‰ç”¨æˆ·ä¼šè¯ã€‚
    2. ä¸Šä¼ æ–‡ä»¶ï¼š
       - æ§åˆ¶è®¡åˆ’æ–‡ä»¶ï¼ˆå¿…é€‰ï¼‰
       - å¾…æ£€æŸ¥æ–‡ä»¶ï¼ˆç›®æ ‡æ–‡ä»¶ï¼Œå¿…é€‰ï¼‰
       - å›¾çº¸æ–‡ä»¶ï¼ˆå¯é€‰ï¼Œç”¨äºå‚è€ƒï¼‰
    3. è¿è¡Œæ–¹å¼ï¼š
       - æŒ‰ä¸‹ã€å¼€å§‹ã€‘ï¼šç³»ç»Ÿä¼šæ ¡éªŒå·²ä¸Šä¼ æ–‡ä»¶å¹¶æ¸…ç†æ—§ç»“æœï¼Œéšåå¯¹â€œæ‚¨ä¸Šä¼ çš„æ–‡ä»¶â€æ‰§è¡Œåˆ†ææµç¨‹ã€‚
       - æŒ‰ä¸‹ã€æ¼”ç¤ºã€‘ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨æ‹·è´ä¸€å¥—ç¤ºä¾‹æ–‡ä»¶åˆ°æ‚¨çš„ä¼šè¯ç›®å½•ï¼Œå¹¶ç«‹å³è¿è¡Œç›¸åŒæµç¨‹ï¼Œä¾¿äºå¿«é€Ÿä¸Šæ‰‹ä½“éªŒã€‚
    4. ç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œä¸‰æ­¥åˆ†æï¼ˆç”¨è¯­å‹å¥½ç‰ˆï¼‰ï¼š
       - ç¬¬ä¸€æ­¥ï¼šAI åŠ©æ‰‹è¯»å–å¹¶ç†è§£å„æ–‡ä»¶ä¸­çš„å‚æ•°è¡¨æ ¼ï¼Œå°†â€œæ§åˆ¶è®¡åˆ’â€å’Œâ€œç›®æ ‡æ–‡ä»¶â€çš„å‚æ•°å†…å®¹æå–ä¸ºç»“æ„åŒ–æ•°æ®ï¼Œæ–¹ä¾¿åç»­é€é¡¹å¯¹æ¯”ã€‚
       - ç¬¬äºŒæ­¥ï¼šç”Ÿæˆâ€œå‚æ•°ä¸€è‡´æ€§è¯„å®¡ç»“è®ºâ€ï¼Œåœ¨é¡µé¢å³ä¾§ä»¥æµå¼æ–¹å¼å±•ç¤ºï¼Œç›´è§‚è¯´æ˜å“ªäº›å‚æ•°ä¸€è‡´ã€å“ªäº›å­˜ç–‘æˆ–ç¼ºå¤±ã€‚
       - ç¬¬ä¸‰æ­¥ï¼šè¿›ä¸€æ­¥æç‚¼â€œä»…ä¸ä¸€è‡´é¡¹â€ï¼Œè‡ªåŠ¨æ•´ç†ä¸ºå¯ä¸‹è½½/ç•™æ¡£çš„è¡¨æ ¼ï¼Œå¹¶ç›´æ¥åœ¨é¡µé¢å±•ç¤ºé¢„è§ˆï¼Œä¾¿äºè¯„å®¡ä¸ä¼ é˜…ã€‚
    5. åœ¨é¡µé¢å³ä¾§æŸ¥çœ‹è¡¨æ ¼ä¸ä¸‹è½½ç»“æœã€‚å¦‚éœ€é‡è·‘ï¼Œå¯ç‚¹å‡»ã€é‡æ–°å¼€å§‹ã€‘ã€‚
    
    ### ğŸ“ æ”¯æŒçš„æ–‡ä»¶ç±»å‹
    
    - æ§åˆ¶è®¡åˆ’æ–‡ä»¶ã€å¾…æ£€æŸ¥æ–‡ä»¶ï¼šExcelï¼ˆ.xlsx / .xlsï¼‰
    - å›¾çº¸æ–‡ä»¶ï¼šPDFï¼ˆ.pdfï¼‰
    
    å¦‚éœ€æ”¯æŒæ›´å¤šæ ¼å¼ï¼Œè¯·è”ç³»ï¼šå‘¨æ˜­å¤ã€‚
    """)

def render_file_elements_check_section():
    """Render the file elements check section."""
    st.header("ğŸ“‹ æ–‡ä»¶è¦ç´ æ£€æŸ¥")
    
    st.markdown("""
    æ–‡ä»¶è¦ç´ æ£€æŸ¥ç”¨äºæ£€æŸ¥APQPæ–‡æ¡£çš„å®Œæ•´æ€§å’Œè§„èŒƒæ€§ï¼Œç¡®ä¿æ‰€æœ‰å¿…è¦çš„è¦ç´ éƒ½å·²åŒ…å«ã€‚
    
    ### æ£€æŸ¥è¦ç´ 
    
    **ğŸ“„ æ–‡æ¡£ç»“æ„**
    - æ ‡é¢˜å’Œç« èŠ‚å®Œæ•´æ€§
    - ç¼–å·å’Œæ ¼å¼è§„èŒƒæ€§
    - å¼•ç”¨å’Œé“¾æ¥æœ‰æ•ˆæ€§
    
    **ğŸ“‹ å†…å®¹è¦ç´ **
    - å¿…è¦ä¿¡æ¯çš„å®Œæ•´æ€§
    - æ•°æ®æ ¼å¼çš„æ­£ç¡®æ€§
    - é€»è¾‘å…³ç³»çš„ä¸€è‡´æ€§
    
    **ğŸ” è´¨é‡è¦ç´ **
    - ç‰¹æ®Šç‰¹æ€§æ ‡è¯†
    - æ§åˆ¶è¦æ±‚æ˜ç¡®æ€§
    - æµ‹é‡æ–¹æ³•æè¿°
    
    ### æ£€æŸ¥æ ‡å‡†
    
    ç³»ç»ŸåŸºäºä»¥ä¸‹æ ‡å‡†è¿›è¡Œæ£€æŸ¥ï¼š
    
    - **APQPæ ‡å‡†**: ç¬¦åˆæ±½è½¦è¡Œä¸šAPQPè¦æ±‚
    - **ISOæ ‡å‡†**: éµå¾ªç›¸å…³ISOè´¨é‡ç®¡ç†æ ‡å‡†
    - **ä¼ä¸šæ ‡å‡†**: ç¬¦åˆä¼ä¸šå†…éƒ¨è´¨é‡è¦æ±‚
    - **è¡Œä¸šæœ€ä½³å®è·µ**: åŸºäºè¡Œä¸šç»éªŒæ€»ç»“
    
    æ³¨æ„ï¼š
    - å½“å‰ä¸ºé¢„è§ˆç‰ˆï¼ŒåŠŸèƒ½ä»åœ¨å®Œå–„ä¸­ï¼›æ­£å¼ç‰ˆé¢„è®¡10æœˆä¸Šçº¿ã€‚
    """)

def render_file_completeness_check_section():
    """Render the file completeness check section."""
    st.header("ğŸ“ æ–‡ä»¶é½å¥—æ€§æ£€æŸ¥")
    
    st.markdown("""
    æ–‡ä»¶é½å¥—æ€§æ£€æŸ¥ç¡®ä¿APQPé¡¹ç›®æ‰€éœ€çš„æ‰€æœ‰æ–‡æ¡£éƒ½å·²å‡†å¤‡å°±ç»ªï¼Œæ²¡æœ‰é—æ¼ã€‚
    
    ### ä½¿ç”¨æµç¨‹

    1. ç™»å½•å¹¶è¿›å…¥æœ¬åŠŸèƒ½é¡µï¼Œç¡®è®¤å½“å‰ç”¨æˆ·ä¼šè¯ã€‚
    2. ä¸Šä¼ æ–‡ä»¶ï¼š
       - è‹¥å³ä¾§å·²åˆ—å‡ºå†å²æ–‡ä»¶ï¼Œå¯å…ˆç‚¹å‡»ã€æ¸…ç©ºæ‰€æœ‰æ–‡ä»¶ã€‘æŒ‰é’®ï¼Œä»¥ç©ºç™½ç¯å¢ƒå¼€å§‹ã€‚
       - æŒ‰é˜¶æ®µä¸Šä¼ ï¼šç«‹é¡¹é˜¶æ®µã€Aæ ·é˜¶æ®µã€Bæ ·é˜¶æ®µã€Cæ ·é˜¶æ®µåˆ†åˆ«ç‚¹å‡»å¯¹åº”ä¸Šä¼ æ¡†æ·»åŠ æ–‡ä»¶ã€‚
       - å³ä¾§â€œæ–‡ä»¶ç®¡ç†å™¨â€å¯éšæ—¶æŸ¥çœ‹/åˆ é™¤å·²ä¸Šä¼ æ–‡ä»¶ï¼Œå¹¶åœ¨æ¯ä¸ªé˜¶æ®µä¸‹æ–¹â€œä¸Šä¼ æ–°æ–‡ä»¶â€å¤„è¡¥å……æ–‡ä»¶ã€‚
    3. è¿è¡Œæ–¹å¼ï¼š
       - è‹¥å³ä¾§å·²åˆ—å‡ºå†å²æ–‡ä»¶ï¼Œå¯å…ˆç‚¹å‡»ã€æ¸…ç©ºæ‰€æœ‰æ–‡ä»¶ã€‘æŒ‰é’®ï¼Œä»¥ç©ºç™½ç¯å¢ƒå¼€å§‹ã€‚
       - æŒ‰ä¸‹ã€å¼€å§‹ã€‘ï¼šç³»ç»Ÿä¼šæ ¡éªŒå¹¶è¯»å–å½“å‰é˜¶æ®µæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ï¼Œæ¸…ç†æ—§ç»“æœåï¼Œç›´æ¥å¯¹â€œæ‚¨ä¸Šä¼ çš„æ–‡ä»¶â€æ‰§è¡Œé½å¥—æ€§åˆ†æã€‚
       - æŒ‰ä¸‹ã€æ¼”ç¤ºã€‘ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨æ‹·è´ä¸€å¥—ç¤ºä¾‹æ–‡ä»¶åˆ°æ‚¨çš„ä¼šè¯ç›®å½•ï¼Œå¹¶ç«‹å³è¿è¡Œç›¸åŒæµç¨‹ï¼Œä¾¿äºå¿«é€Ÿä¸Šæ‰‹ä½“éªŒã€‚
    4. ç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œåˆ†æï¼ˆç”¨è¯­å‹å¥½ç‰ˆï¼‰ï¼š
       - ç¬¬ä¸€æ­¥ï¼šæŒ‰APQPé˜¶æ®µè¯»å–â€œåº”åŒ…å«çš„äº¤ä»˜ç‰©æ–‡ä»¶æ¸…å•â€ï¼Œä¸å¯¹åº”é˜¶æ®µæ–‡ä»¶å¤¹ä¸­çš„å®é™…æ–‡ä»¶è¿›è¡Œåç§°è¿‘ä¼¼åŒ¹é…ï¼Œå¯¹æ¯ä¸€é¡¹ç»™å‡ºâ€œå­˜åœ¨/ä¸å­˜åœ¨â€åˆ¤æ–­ä»¥åŠåŒ¹é…åˆ°çš„æ–‡ä»¶åã€‚
       - ç¬¬äºŒæ­¥ï¼šå°†å¤šé˜¶æ®µç»“æœç»Ÿä¸€æ•´ç†ä¸ºæ ‡å‡†åŒ–è¡¨æ ¼ï¼ŒåŒ…å«åˆ—ï¼šStageã€Deliverableã€Existsã€FileNameã€Notesï¼Œå¹¶åœ¨é¡µé¢å³ä¾§ç›´æ¥å±•ç¤ºé¢„è§ˆã€‚
       - ç¬¬ä¸‰æ­¥ï¼šå¯¼å‡ºå¯ä¸‹è½½çš„Excelæ–‡ä»¶ï¼Œä¾¿äºè¯„å®¡ã€å½’æ¡£ä¸ä¼ é˜…ã€‚
    5. åœ¨é¡µé¢å³ä¾§æŸ¥çœ‹è¡¨æ ¼ä¸ä¸‹è½½çš„Excelã€‚å¦‚éœ€é‡è·‘ï¼Œå¯ç‚¹å‡»ã€é‡æ–°å¼€å§‹ã€‘ã€‚
    
    ### ğŸ¯ æ£€æŸ¥æ¸…å•
    
    ä»¥ä¸‹æ˜¯é»˜è®¤æ¸…å•ï¼Œå¦‚æœéœ€è¦æ¢æˆä¸åŒçš„æ¸…å•ï¼Œå¯ä»¥åœ¨é¡µé¢ä¸Šä¼ ã€‚
    - **ç«‹é¡¹é˜¶æ®µ**: é¡¹ç›®ç«‹é¡¹æŠ¥å‘Šã€é¡¹ç›®å¯è¡Œæ€§åˆ†ææŠ¥å‘Šã€é¡¹ç›®é£é™©è¯„ä¼°æŠ¥å‘Šã€é¡¹ç›®è®¡åˆ’ä¹¦ã€é¡¹ç›®å›¢é˜Ÿç»„å»ºæ–¹æ¡ˆã€é¡¹ç›®é¢„ç®—æ–¹æ¡ˆã€é¡¹ç›®æ—¶é—´è®¡åˆ’ã€é¡¹ç›®è´¨é‡ç›®æ ‡ã€é¡¹ç›®æˆæœ¬ç›®æ ‡ã€é¡¹ç›®äº¤ä»˜ç‰©æ¸…å•
    - **Aæ ·é˜¶æ®µ**: ç”µèŠ¯è§„æ ¼ä¹¦ã€å°ºå¯¸é“¾å…¬å·®è®¡ç®—ä¹¦ã€åˆå§‹DFMEAã€åˆå§‹ç‰¹æ®Šç‰¹æ€§æ¸…å•ã€ä¸‰æ–°æ¸…å•ã€åˆ¶ç¨‹æ ‡å‡†ã€å¼€æ¨¡æ¸…å•ã€3Dæ•°æ¨¡ã€2Då›¾çº¸ã€BOMæ¸…å•ã€ä»¿çœŸæŠ¥å‘Šã€æµ‹è¯•å¤§çº²ã€ä¸“åˆ©æŒ–æ˜æ¸…å•ã€åˆç‰ˆPFMEAã€äº§çº¿è§„åˆ’æ–¹æ¡ˆã€è¿‡ç¨‹è®¾è®¡åˆå§‹æ–¹æ¡ˆã€äº§å“å¯åˆ¶é€ æ€§åˆ†æåŠé£é™©åº”å¯¹æŠ¥å‘Šã€åˆå§‹è¿‡ç¨‹æµç¨‹å›¾ã€åˆå§‹è¿‡ç¨‹ç‰¹æ®Šç‰¹æ€§ã€åˆç‰ˆCPã€åˆç‰ˆSOPã€å·¥è‰ºéªŒè¯è®¡åˆ’ã€æ ·å“åŒ…è£…æ–¹æ¡ˆ
    - **Bæ ·é˜¶æ®µ**: è®¾è®¡å˜æ›´å±¥å†è¡¨ã€æ›´æ–°ç”µèŠ¯è§„æ ¼ä¹¦ã€æ›´æ–°DFMEAã€æ›´æ–°ç‰¹æ®Šç‰¹æ€§æ¸…å•ã€åˆ¶ç¨‹æ ‡å‡†ã€æ›´æ–°3Dæ•°æ¨¡ã€æ›´æ–°2Då›¾çº¸ã€å°ºå¯¸é“¾å…¬å·®è®¡ç®—ä¹¦ã€æ›´æ–°BOMæ¸…å•ã€æ›´æ–°å¼€æ¨¡æ¸…å•ã€æ›´æ–°ä¸‰æ–°æ¸…å•ã€ä»¿çœŸæŠ¥å‘Šã€DVæµ‹è¯•æŠ¥å‘Š
    - **Cæ ·é˜¶æ®µ**: æ›´æ–°PFMEAã€é‡äº§äº§çº¿å¼€å‘è¿›å±•æŠ¥å‘Šã€æ›´æ–°æ ·å“åŒ…è£…æ–¹æ¡ˆã€æ›´æ–°è¿‡ç¨‹ç‰¹æ®Šç‰¹æ€§æ¸…å•ã€æ›´æ–°CPã€æ›´æ–°SOPã€å·¥è‰ºéªŒè¯è®¡åˆ’ã€æ ·å“å†å²é—®é¢˜æ¸…å•ã€CMKåˆ†ææŠ¥å‘Šã€CPKåˆ†ææŠ¥å‘Šã€å·¥ç¨‹å˜æ›´å±¥å†è¡¨ã€äº§å“å¯åˆ¶é€ æ€§åˆ†æä¸é£é™©åº”å¯¹æŠ¥å‘Šã€æ›´æ–°è¿‡ç¨‹æµç¨‹å›¾ã€æ›´æ–°è¿‡ç¨‹ç‰¹æ®Šç‰¹æ€§æ¸…å•ã€è®¾å¤‡åœæœºç‡ç»Ÿè®¡è¡¨&è®¾å¤‡æ•…éšœè®°å½•è¡¨ã€å·¥è‰ºéªŒè¯æŠ¥å‘Šã€å¤–è§‚æ ‡å‡†ä¹¦ã€PVæµ‹è¯•æŠ¥å‘Š
    
    ### ğŸ“Š æ£€æŸ¥ç»“æœ
    
    - **å®Œæ•´**: æ‰€æœ‰å¿…è¦æ–‡ä»¶éƒ½å·²å‡†å¤‡
    - **éƒ¨åˆ†å®Œæ•´**: å¤§éƒ¨åˆ†æ–‡ä»¶å·²å‡†å¤‡ï¼Œå°‘é‡ç¼ºå¤±
    - **ä¸å®Œæ•´**: å¤šä¸ªé‡è¦æ–‡ä»¶ç¼ºå¤±
    - **ç¼ºå¤±**: å…³é”®æ–‡ä»¶ç¼ºå¤±ï¼Œéœ€è¦ç«‹å³è¡¥å……

    ### ğŸ“ æ”¯æŒçš„æ–‡ä»¶ç±»å‹

    - æ‰€æœ‰æ–‡ä»¶ç±»å‹
    """)

def render_history_issues_avoidance_section():
    """Render the history issues avoidance section."""
    st.header("ğŸ“š å†å²é—®é¢˜è§„é¿")
    
    st.markdown("""
    å†å²é—®é¢˜è§„é¿åŠŸèƒ½å¸®åŠ©ç”¨æˆ·ä»å†å²é¡¹ç›®ä¸­å­¦ä¹ ï¼Œé¿å…é‡å¤å‡ºç°ç›¸åŒçš„é—®é¢˜ã€‚
    
    ### ğŸ¯ åŠŸèƒ½ç‰¹ç‚¹
    
    **ğŸ“Š é—®é¢˜åˆ†æ**
    - å†å²é—®é¢˜ç»Ÿè®¡åˆ†æ
    - é—®é¢˜ç±»å‹åˆ†ç±»
    - æ ¹æœ¬åŸå› åˆ†æ
    
    **ğŸ” æ™ºèƒ½åŒ¹é…**
    - å½“å‰é¡¹ç›®ä¸å†å²é¡¹ç›®å¯¹æ¯”
    - ç›¸ä¼¼é—®é¢˜è‡ªåŠ¨è¯†åˆ«
    - é£é™©é¢„è­¦æç¤º
    
    **ğŸ“‹ è§£å†³æ–¹æ¡ˆ**
    - å†å²è§£å†³æ–¹æ¡ˆæ¨è
    - æœ€ä½³å®è·µåˆ†äº«
    - é¢„é˜²æªæ–½å»ºè®®
    
    æ³¨æ„ï¼š
    - å½“å‰ä¸ºé¢„è§ˆç‰ˆï¼ŒåŠŸèƒ½ä»åœ¨å®Œå–„ä¸­ï¼›æ­£å¼ç‰ˆé¢„è®¡10æœˆä¸Šçº¿ã€‚
    """)

def render_ai_agent_section():
    """Render the AI Agent section."""
    st.header("ğŸ¤– AIæ™ºèƒ½ä½“")

    st.markdown("""
    AIæ™ºèƒ½ä½“ç”¨äºé€šç”¨æ™ºèƒ½é—®ç­”ä¸ä»»åŠ¡åä½œã€‚ä½ å¯ä»¥å°±APQPæµç¨‹ã€è´¨é‡å·¥å…·ã€æˆ–æŸä¸ªå…·ä½“æ–‡æ¡£æå‡ºé—®é¢˜ï¼ŒAIæ™ºèƒ½ä½“ä¼šè‡ªåŠ¨è§„åˆ’å“åº”ï¼Œå¹¶æŒ‰éœ€è°ƒç”¨å·¥å…·å®Œæˆä»»åŠ¡ã€‚

    ### åŠŸèƒ½æ¦‚è¿°

    - **é€šç”¨é—®ç­”**: å…³äºAPQPæµç¨‹ã€é˜¶æ®µäº¤ä»˜ç‰©ã€æ§åˆ¶è®¡åˆ’ã€FMEAç­‰çš„çŸ¥è¯†æ€§é—®é¢˜ã€‚
    - **æ–‡æ¡£ç†è§£**: é’ˆå¯¹ä¸Šä¼ çš„æ–‡æ¡£æå‡ºé—®é¢˜ï¼ˆå¦‚å®šä½æ¡ç›®ã€è§£é‡Šå­—æ®µå«ä¹‰ã€æ±‡æ€»è¦ç‚¹ï¼‰ã€‚
    - **å·¥å…·è°ƒç”¨ï¼ˆè‡ªåŠ¨ï¼‰**: æŒ‰éœ€ä½¿ç”¨äº’è”ç½‘æœç´¢ã€Pythonä»£ç ç¼–å†™ä¸æ‰§è¡Œã€æ•°æ®å¤„ç†/è¡¨æ ¼åˆ†æã€æ–‡æ¡£è§£æç­‰èƒ½åŠ›ã€‚
    - **é€æ­¥è®¡åˆ’**: è‡ªåŠ¨æ‹†è§£é—®é¢˜ã€è§„åˆ’æ­¥éª¤å¹¶ç»™å‡ºå¯è¿½æº¯çš„ä¸­é—´ç»“è®ºã€‚

    ### ä½¿ç”¨æµç¨‹

    1. è¿›å…¥â€œğŸ¤– AIæ™ºèƒ½ä½“â€é¡µé¢ã€‚
    2. åœ¨åº•éƒ¨è¾“å…¥é—®é¢˜æˆ–ä»»åŠ¡è¯´æ˜ï¼ˆå¯å¼•ç”¨åœºæ™¯ï¼šAPQPé˜¶æ®µè¯´æ˜ã€æŸExcelè¡¨æ ¼ç»Ÿè®¡éœ€æ±‚ã€æœ¯è¯­è§£é‡Šç­‰ï¼‰ã€‚
    3. AIæ™ºèƒ½ä½“ä¼šè‡ªåŠ¨è§„åˆ’å¹¶é€æ­¥ç”Ÿæˆå›ç­”ï¼Œå¿…è¦æ—¶è°ƒç”¨å·¥å…·å®Œæˆæ£€ç´¢ã€åˆ†ææˆ–è®¡ç®—ã€‚
    4. å¦‚éœ€æ›´æ·±å…¥ï¼Œå¯è¿½é—®æˆ–è¦æ±‚ç”Ÿæˆè„šæœ¬/è¡¨æ ¼å¹¶æŸ¥çœ‹ç»“æœã€‚

    æ³¨æ„ï¼š
    - å½“å‰ä¸ºé¢„è§ˆç‰ˆï¼Œå·¥å…·é›†åˆä¸èƒ½åŠ›ä»åœ¨å®Œå–„ä¸­ï¼›æ­£å¼ç‰ˆé¢„è®¡10æœˆä¸Šçº¿ã€‚
    """)
    
def render_settings_section():
    """Render the settings section."""
    st.header("âš™ï¸ è®¾ç½®")
    
    st.markdown("""
    æœ¬é¡µç”¨äºé…ç½®ç³»ç»Ÿä½¿ç”¨çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åç«¯ã€æ¨¡å‹ä¸æ¨ç†å‚æ•°ï¼Œå¹¶æŸ¥çœ‹è¿æ¥çŠ¶æ€ä¸å½“å‰é…ç½®æ¦‚è§ˆã€‚å˜æ›´å°†å½±å“å„åŠŸèƒ½é¡µçš„AIè¡Œä¸ºä¸æ€§èƒ½è¡¨ç°ã€‚

    âš ï¸ è­¦å‘Šï¼š
    - é™¤éä½ ç†Ÿæ‚‰å¤§è¯­è¨€æ¨¡å‹ï¼Œå¦åˆ™ä¸è¦ä¿®æ”¹è®¾ç½®ï¼
    - Do not change the settings unless you know exactly what you are doing!"

    ### ğŸ”§ åç«¯é€‰æ‹©ï¼ˆé€‰æ‹©å¤§è¯­è¨€æ¨¡å‹ï¼‰
    - **Ollama (10.31.60.127:11434 / 10.31.60.9:11434)**ï¼šä½¿ç”¨å†…ç½‘Ollamaæ¨ç†æœåŠ¡ã€‚æœ¬åœ°/å†…ç½‘æ¨¡å‹æ¨ç†ï¼Œå»¶è¿Ÿä½ã€å¯ç¦»çº¿ã€‚
    - **OpenAI (sg.uiuiapi.com)**ï¼šé€šè¿‡ä»£ç†ç½‘å…³è®¿é—®OpenAIå…¼å®¹æ¥å£ã€‚åŠŸèƒ½æ›´å…¨ï¼Œä½†ä¾èµ–ç½‘ç»œä¸APIå¯ç”¨æ€§ã€‚

    é€‰æ‹©åç«¯å°†å†³å®šåç»­â€œæ¨¡å‹é…ç½®â€ä¸â€œè¿æ¥çŠ¶æ€â€çš„å†…å®¹å’Œå¯ç”¨é€‰é¡¹ã€‚

    ### ğŸ”— è¿æ¥çŠ¶æ€
    - è‡ªåŠ¨æ£€æµ‹æ‰€é€‰åç«¯çš„å¯ç”¨æ€§å¹¶æ˜¾ç¤ºâ€œåœ¨çº¿/ç¦»çº¿â€ã€‚
    - Ollama ä¼šæ£€æµ‹ç›®æ ‡ä¸»æœºè¿é€šæ€§ï¼›OpenAI ä¼šæ£€æµ‹ API Key ä¸ç½‘å…³è¿é€šæ€§ã€‚
    - è‹¥æ˜¾ç¤ºç¦»çº¿ï¼Œè¯·å…ˆæ£€æŸ¥ç½‘ç»œã€ä»£ç†ã€æœåŠ¡æ˜¯å¦å¯åŠ¨ã€‚

    ### âš™ï¸ æ¨¡å‹é…ç½®
    è§†æ‰€é€‰åç«¯æ˜¾ç¤ºå¯¹åº”çš„æ¨¡å‹ä¸å‚æ•°ã€‚

    #### å½“é€‰æ‹© Ollama æ—¶
    - **é€‰æ‹©Ollamaæ¨¡å‹**ï¼šä»æœåŠ¡ç«¯å¯ç”¨æ¨¡å‹ä¸­é€‰æ‹©ï¼ˆå¦‚ qwenã€llama ç­‰ï¼‰ã€‚
    - **Temperature (æ¸©åº¦)**ï¼šæ§åˆ¶è¾“å‡ºéšæœºæ€§ã€‚ä½=æ›´ç¨³å®šï¼Œ é«˜=æ›´æœ‰åˆ›é€ æ€§ã€‚å¸¸ç”¨ 0.3â€“0.7ã€‚
    - **Top-p (æ ¸é‡‡æ ·)**ï¼šæ§åˆ¶è¯æ±‡å¤šæ ·æ€§ï¼Œé…åˆæ¸©åº¦ä½¿ç”¨ã€‚å¸¸ç”¨ 0.8â€“0.95ã€‚
    - **Top-k**ï¼šé™åˆ¶æ¯æ­¥å¯é€‰è¯æ±‡æ•°é‡ã€‚è¾ƒå°=æ›´ä¿å®ˆï¼Œé»˜è®¤ 40ã€‚
    - **Repeat Penalty (é‡å¤æƒ©ç½š)**ï¼šæŠ‘åˆ¶èµ˜è¿°/å¤è¯»ï¼Œ>1 å¢å¼ºæƒ©ç½šã€‚é»˜è®¤ 1.1ã€‚
    - **ä¸Šä¸‹æ–‡çª—å£å¤§å° (num_ctx)**ï¼šå¯å¤„ç†çš„æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆtokenï¼‰ã€‚æ›´å¤§å¯æ‰¿è½½æ›´é•¿æ–‡æ¡£ï¼Œä½†æ›´è€—å†…å­˜ã€‚
    - **çº¿ç¨‹æ•° (num_thread)**ï¼šCPU æ¨ç†çº¿ç¨‹æ•°ã€‚æ›´é«˜å¯åŠ å¿«æ¨ç†ï¼ˆå—æœºå™¨æ€§èƒ½é™åˆ¶ï¼‰ã€‚

    #### å½“é€‰æ‹© OpenAI æ—¶
    - **é€‰æ‹©OpenAIæ¨¡å‹**ï¼šé€‰æ‹©å…·ä½“æ¨¡å‹ï¼ˆä¾‹å¦‚ gpt-4 å…¼å®¹æ¨¡å‹ï¼‰ã€‚
    - **Temperature (æ¸©åº¦)**ï¼šåŒä¸Šï¼Œ0=ç¡®å®šæ€§ï¼Œ2=æœ€å¤§éšæœºæ€§ã€‚
    - **Top-p (æ ¸é‡‡æ ·)**ï¼šåŒä¸Šï¼Œç”¨äºæ§åˆ¶å¤šæ ·æ€§ã€‚
    - **æœ€å¤§è¾“å‡ºé•¿åº¦ (max_tokens)**ï¼šé™åˆ¶å•æ¬¡å›å¤çš„æœ€å¤§tokenæ•°ï¼›æ›´å¤§å¯èƒ½æˆªæ–­æ›´å°‘ï¼Œä½†æ›´è€—è´¹é¢åº¦ã€‚
    - **Presence Penalty (å­˜åœ¨æƒ©ç½š)**ï¼šå‡å°‘é‡å¤ä¸»é¢˜å‡ºç°çš„å€¾å‘ï¼Œ>0æ›´é¼“åŠ±å¼•å…¥æ–°ä¸»é¢˜ã€‚
    - **Frequency Penalty (é¢‘ç‡æƒ©ç½š)**ï¼šå‡å°‘é‡å¤è¯æ±‡å‡ºç°çš„å€¾å‘ï¼Œ>0æ›´æŠ‘åˆ¶é‡å¤ç”¨è¯ã€‚
    - **Logit Bias (è¯æ±‡åå¥½)**ï¼šJSON é…ç½®ï¼Œå¾®è°ƒç‰¹å®šè¯æ±‡å‡ºç°æ¦‚ç‡ï¼ˆé«˜çº§ç”¨æ³•ï¼‰ã€‚

    ### ğŸ“‹ å½“å‰é…ç½®æ¦‚è§ˆ
    - å®æ—¶å±•ç¤ºâ€œåç«¯/ä¸»æœºï¼ˆæˆ–APIï¼‰/å½“å‰æ¨¡å‹/å…³é”®å‚æ•°â€çš„å¿«ç…§ï¼Œä¾¿äºæ ¸å¯¹æ˜¯å¦æŒ‰é¢„æœŸé…ç½®ã€‚

    ### ğŸ“š ç›¸å…³æ–‡æ¡£
    - å¿«é€Ÿè®¿é—® Ollama ä¸ OpenAI çš„å®˜æ–¹æ–‡æ¡£ä¸å‚æ•°è¯´æ˜ã€‚

    ### ğŸ’¾ ä¿å­˜ä¸ç”Ÿæ•ˆ
    - å‚æ•°è°ƒæ•´ä¼šè‡ªåŠ¨ä¿å­˜ï¼›æ¨¡å‹åˆ‡æ¢ä¼šæç¤ºâ€œå°†åœ¨ä¸‹æ¬¡è¿è¡Œæ—¶ç”Ÿæ•ˆâ€ï¼ˆé¿å…ä¸­æ–­å½“å‰ä»»åŠ¡ï¼‰ã€‚
    - è‹¥é‡åˆ°å¼‚å¸¸ï¼Œå¯åˆ·æ–°é¡µé¢æˆ–åœ¨è®¾ç½®ä¸­é‡æ–°é€‰æ‹©åç«¯ä¸æ¨¡å‹ã€‚

    ### âœ… å»ºè®®é…ç½®ï¼ˆè‹¥ä¸ç¡®å®šï¼‰
    - Ollamaï¼šTemperature 0.3ã€Top-p 0.9ã€Top-k 40ã€Repeat Penalty 1.1ã€num_ctx æŒ‰é»˜è®¤å€¼ã€num_thread ä¾æ®CPUæ ¸å¿ƒæ•°åˆç†è®¾ç½®ã€‚
    - OpenAIï¼šTemperature 0.3ã€Top-p 1.0ã€max_tokens é€‚ä¸­ã€Presence/Frequency Penalty 0.0ã€Logit Bias ç•™ç©ºã€‚
    """)

def render_faq_section():
    """Render the FAQ section."""
    st.header("â“ å¸¸è§é—®é¢˜")
    
    st.markdown("""
    ### ğŸ¤” ä½¿ç”¨é—®é¢˜
    
    **Q: å¦‚ä½•å¼€å§‹ä½¿ç”¨ç³»ç»Ÿï¼Ÿ**
    A: é¦–å…ˆç™»å½•ç³»ç»Ÿï¼Œç„¶åé€‰æ‹©ç›¸åº”çš„åŠŸèƒ½æ¨¡å—ï¼Œä¸Šä¼ æ–‡ä»¶åç‚¹å‡»"å¼€å§‹"æŒ‰é’®å³å¯ã€‚
    
    **Q: æ”¯æŒå“ªäº›æ–‡ä»¶æ ¼å¼ï¼Ÿ**
    A: ç³»ç»Ÿæ”¯æŒExcelã€Wordã€PDFã€æ–‡æœ¬æ–‡ä»¶ç­‰å¤šç§æ ¼å¼ã€‚
    
    **Q: åˆ†æç»“æœå¦‚ä½•ä¿å­˜ï¼Ÿ**
    A: åˆ†æç»“æœå¯ä»¥å¯¼å‡ºä¸ºExcelæˆ–PDFæ ¼å¼ï¼Œä¹Ÿå¯ä»¥åœ¨çº¿æŸ¥çœ‹ã€‚
    
    **Q: å¦‚ä½•å¤„ç†å¤§æ–‡ä»¶ï¼Ÿ**
    A: ç³»ç»Ÿæ”¯æŒå¤§æ–‡ä»¶å¤„ç†ï¼Œå»ºè®®åˆ†æ‰¹å¤„ç†ä»¥æé«˜æ•ˆç‡ã€‚
    
    ### ğŸ”§ æŠ€æœ¯é—®é¢˜
    
    **Q: ç³»ç»Ÿå“åº”æ…¢æ€ä¹ˆåŠï¼Ÿ**
    A: å¯ä»¥å°è¯•åˆ·æ–°é¡µé¢ï¼Œæˆ–è€…æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚
    
    **Q: å¦‚ä½•æ›´æ–°æ¨¡å‹è®¾ç½®ï¼Ÿ**
    A: åœ¨è®¾ç½®é¡µé¢å¯ä»¥ä¿®æ”¹æ¨¡å‹å‚æ•°ï¼Œä¿®æ”¹åç«‹å³ç”Ÿæ•ˆã€‚
    
    **Q: æ”¯æŒå¤šç”¨æˆ·åŒæ—¶ä½¿ç”¨å—ï¼Ÿ**
    A: æ˜¯çš„ï¼Œç³»ç»Ÿæ”¯æŒå¤šç”¨æˆ·åŒæ—¶ä½¿ç”¨ï¼Œæ¯ä¸ªç”¨æˆ·çš„æ•°æ®ç›¸äº’éš”ç¦»ã€‚
    
    ### ğŸ“ è”ç³»æ”¯æŒ
    
    å¦‚æœé‡åˆ°å…¶ä»–é—®é¢˜ï¼Œè¯·è”ç³»å‘¨æ˜­å¤ã€‚
    """)

def render_technical_docs_section(session_id):
    """Render the technical documentation section."""
    st.header("ğŸ“š æŠ€æœ¯æ–‡æ¡£")
    
    st.markdown("""
    ### ä¼ä¸šæ ‡å‡†æ£€æŸ¥éƒ¨ç½²ç»†èŠ‚
    
    #### æœåŠ¡æ¶æ„æ¦‚è¿°
    
    ä¼ä¸šæ ‡å‡†æ£€æŸ¥åŠŸèƒ½ä¾èµ–ä»¥ä¸‹å…³é”®æœåŠ¡ï¼š
    1. **MinerUæœåŠ¡** (10.31.60.127:8000) - PDFè§£æ
    2. **UnstructuredæœåŠ¡** (10.31.60.11:8000) - Word/PPTè§£æ  
    3. **OllamaæœåŠ¡** (10.31.60.9:11434) - LLMæ¨ç†
    4. **PQM_AIåº”ç”¨** (10.31.60.127) - ä¸»åº”ç”¨
    
    #### æœåŠ¡å¯åŠ¨ä¸ç»´æŠ¤
    
    **1. MinerUæœåŠ¡ (10.31.60.127:8000)**
    
    SSHç™»å½•æœåŠ¡å™¨ï¼š
    ```bash
    ssh -o ServerAliveInterval=130 -o ServerAliveCountMax=6 calb@10.31.60.127
    pwd 0000
    ```
    
    æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š
    ```bash
    sudo su
    docker ps | grep mineru
    ```
    
    å¯åŠ¨æœåŠ¡ï¼ˆå¦‚æœæœªè¿è¡Œï¼‰ï¼š
    ```bash
    # ä¸‹è½½ä¿®æ”¹åçš„compose.yamlåˆ°MinerUç›®å½•
    # åŸå§‹æ–‡ä»¶ï¼šwget https://gcore.jsdelivr.net/gh/opendatalab/MinerU@master/docker/compose.yaml
    # å·²ä¿®æ”¹ç‰ˆæœ¬ï¼ˆå–æ¶ˆæ³¨é‡Š--mem-fraction-static 0.5ï¼‰ï¼šä»PQM_AIé¡¹ç›®è·å–
    # å°† [compose.yaml](demonstration/compose.yaml) å¤åˆ¶åˆ°æœåŠ¡å™¨MinerUç›®å½•
    
    # è¿›å…¥MinerUç›®å½•
    cd /path/to/MinerU
    
    # ä½¿ç”¨Docker Composeå¯åŠ¨APIæœåŠ¡
    docker compose -p mineru -f compose.yaml --profile api up -d
    ```
    
    é‡å¯æœåŠ¡ï¼š
    ```bash
    docker compose -p mineru -f compose.yaml --profile api restart
    ```
    
    æŸ¥çœ‹æ—¥å¿—ï¼š
    ```bash
    docker logs mineru-api
    ```
    
    åœæ­¢æœåŠ¡ï¼š
    ```bash
    docker compose -p mineru -f compose.yaml --profile api down
    ```
    
    **Dockeré•œåƒä¿¡æ¯**ï¼š
    - é•œåƒåï¼š`mineru-sglang:latest`
    - å®¹å™¨åï¼š`mineru-api`
    - ç«¯å£æ˜ å°„ï¼š`0.0.0.0:8000->8000/tcp`
    - GPUå†…å­˜ä½¿ç”¨ï¼š~13.4GB/24GB (RTX 3090)
    
    **é‡è¦é…ç½®è¯´æ˜**ï¼š
    - ä½¿ç”¨çš„compose.yamlå·²ä¿®æ”¹ï¼šå–æ¶ˆæ³¨é‡Šäº†`--mem-fraction-static 0.5`å‚æ•°
    """)

    try:
        compose_path = (Path(__file__).resolve().parent.parent / "demonstration" / "compose.yaml")
        if compose_path.exists():
            with compose_path.open("rb") as f:
                compose_bytes = f.read()
            st.download_button(
                label="â¬‡ï¸ ä¸‹è½½ä¿®æ”¹ç‰ˆ compose.yaml",
                data=compose_bytes,
                file_name="compose.yaml",
                mime="application/x-yaml"
                )
        else:
            st.warning(f"æœªæ‰¾åˆ°compose.yamlï¼š{compose_path}")
    except Exception as e:
        st.warning(f"æ— æ³•æä¾›compose.yamlä¸‹è½½ï¼š{e}")
    st.text("åŸå§‹æ–‡ä»¶ï¼šhttps://gcore.jsdelivr.net/gh/opendatalab/MinerU@master/docker/compose.yaml")

    st.markdown("""
    - æ­¤ä¿®æ”¹è§£å†³äº†GPUå†…å­˜ä¸è¶³å¯¼è‡´çš„OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰é—®é¢˜
    
    **2. UnstructuredæœåŠ¡ (10.31.60.11:8000)**
    
    SSHç™»å½•æœåŠ¡å™¨ï¼š
    ```bash
    ssh -o ServerAliveInterval=130 -o ServerAliveCountMax=6 file-translation@10.31.60.11
    pwd calb147258
    ```
    
    æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š
    ```bash
    docker ps | grep unstructured
    ```
    
    å¯åŠ¨æœåŠ¡ï¼ˆå¦‚æœæœªè¿è¡Œï¼‰ï¼š
    ```bash
    # æ‹‰å–æœ€æ–°é•œåƒ
    docker pull downloads.unstructured.io/unstructured-io/unstructured-api:latest
    
    # å¯åŠ¨APIå®¹å™¨
    docker run -d --name unstructured-api --restart unless-stopped \\
      -p 8000:8000 \\
      -e PIPELINE_CONCURRENCY_LIMIT=4 \\
      -e ENABLE_CLEANING=1 \\
      downloads.unstructured.io/unstructured-io/unstructured-api:latest
    ```
    
    é‡å¯æœåŠ¡ï¼š
    ```bash
    docker restart unstructured-api
    ```
    
    æŸ¥çœ‹æ—¥å¿—ï¼š
    ```bash
    docker logs unstructured-api
    ```
    
    åœæ­¢æœåŠ¡ï¼š
    ```bash
    docker stop unstructured-api
    ```
    
    **3. OllamaæœåŠ¡ (10.31.60.9:11434)**
    
    SSHç™»å½•æœåŠ¡å™¨ï¼š
    ```bash
    ssh -o ServerAliveInterval=130 -o ServerAliveCountMax=6 translation-service@10.31.60.9
    pwd calb147258
    ```
    
    æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š
    ```bash
    systemctl status ollama
    ```
    
    å¯åŠ¨æœåŠ¡ï¼š
    ```bash
    systemctl start ollama
    ```
    
    é‡å¯æœåŠ¡ï¼š
    ```bash
    systemctl restart ollama
    ```
    
    æŸ¥çœ‹æ—¥å¿—ï¼š
    ```bash
    journalctl -u ollama -f
    ```
    
    #### æ•…éšœè¯Šæ–­ä¸ä¿®å¤
    
    **1. æœåŠ¡è¿é€šæ€§æ£€æŸ¥**
    
    åœ¨PQM_AIåº”ç”¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š
    ```bash
    # æ£€æŸ¥MinerUæœåŠ¡
    curl -X GET http://10.31.60.127:8000/health
    
    # æ£€æŸ¥UnstructuredæœåŠ¡  
    curl -X GET http://10.31.60.11:8000/health
    
    # æ£€æŸ¥OllamaæœåŠ¡
    curl -X GET http://10.31.60.9:11434/api/tags
    ```
    
    **2. å¸¸è§æ•…éšœåŠè§£å†³æ–¹æ¡ˆ**
    
    **MinerUæœåŠ¡æ•…éšœ**ï¼š
    - ç—‡çŠ¶ï¼šPDFæ–‡ä»¶è§£æå¤±è´¥ï¼Œè¿”å›è¿æ¥é”™è¯¯
    - æ£€æŸ¥ï¼š`docker logs mineru-api`
    - å¸¸è§åŸå› ï¼šGPUå†…å­˜ä¸è¶³ã€å®¹å™¨å´©æºƒ
    - è§£å†³ï¼šé‡å¯å®¹å™¨ï¼Œæ£€æŸ¥GPUå†…å­˜ä½¿ç”¨æƒ…å†µ
    
    **UnstructuredæœåŠ¡æ•…éšœ**ï¼š
    - ç—‡çŠ¶ï¼šWord/PPTæ–‡ä»¶è§£æå¤±è´¥
    - æ£€æŸ¥ï¼š`docker logs unstructured-api`
    - å¸¸è§åŸå› ï¼šå†…å­˜ä¸è¶³ã€ç«¯å£å†²çª
    - è§£å†³ï¼šé‡å¯å®¹å™¨ï¼Œæ£€æŸ¥ç«¯å£8000æ˜¯å¦è¢«å ç”¨
    
    **OllamaæœåŠ¡æ•…éšœ**ï¼š
    - ç—‡çŠ¶ï¼šLLMè°ƒç”¨å¤±è´¥ï¼ŒAIåŠŸèƒ½ä¸å¯ç”¨
    - æ£€æŸ¥ï¼š`journalctl -u ollama`
    - å¸¸è§åŸå› ï¼šæ¨¡å‹æ–‡ä»¶æŸåã€å†…å­˜ä¸è¶³
    - è§£å†³ï¼šé‡å¯æœåŠ¡ï¼Œæ£€æŸ¥å¯ç”¨æ¨¡å‹
    
    **3. æ—¥å¿—ä½ç½®**
    
    **MinerUæ—¥å¿—**ï¼š
    ```bash
    # å®¹å™¨æ—¥å¿—
    docker logs mineru-api --tail 100
    
    # ç³»ç»Ÿæ—¥å¿—ï¼ˆå¦‚æœä½¿ç”¨systemdï¼‰
    journalctl -u docker --since "1 hour ago"
    ```
    
    **Unstructuredæ—¥å¿—**ï¼š
    ```bash
    # å®¹å™¨æ—¥å¿—
    docker logs unstructured-api --tail 100
    ```
    
    **Ollamaæ—¥å¿—**ï¼š
    ```bash
    # æœåŠ¡æ—¥å¿—
    journalctl -u ollama --since "1 hour ago"
    ```
    
    **PQM_AIåº”ç”¨æ—¥å¿—**ï¼š
    ```bash
    # Streamlitåº”ç”¨æ—¥å¿—ï¼ˆåœ¨åº”ç”¨è¿è¡Œç»ˆç«¯æŸ¥çœ‹ï¼‰
    # æˆ–æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—
    journalctl --since "1 hour ago" | grep streamlit
    ```
    
    #### é…ç½®ç®¡ç†
    
    **1. æœåŠ¡ç«¯ç‚¹é…ç½®**
    
    åœ¨`config.py`ä¸­é…ç½®ï¼š
    ```python
    CONFIG = {
        "services": {
            "unstructured_api_url": "http://10.31.60.11:8000/general/v0/general",
            "mineru_api_url": "http://10.31.60.127:8000/file_parse"
        },
        "llm": {
            "ollama_host": "http://10.31.60.9:11434"
        }
    }
    ```
    
    **2. ç¯å¢ƒå˜é‡è¦†ç›–**
    
    è®¾ç½®ç¯å¢ƒå˜é‡å¯è¦†ç›–é…ç½®æ–‡ä»¶ï¼š
    ```bash
    export UNSTRUCTURED_API_URL="http://10.31.60.11:8000/general/v0/general"
    export OLLAMA_HOST="http://10.31.60.9:11434"
    ```
    
    #### å¤‡ä»½ä¸æ¢å¤
    
    **1. é‡è¦æ–‡ä»¶å¤‡ä»½**
    
    ```bash
    # å¤‡ä»½ç”¨æˆ·æ•°æ®
    tar -czf pqm_backup_$(date +%Y%m%d).tar.gz \\
      generated_files/ \\
      user_sessions/ \\
      user_settings/ \\
      enterprise_standard_files/
    
    # å¤‡ä»½é…ç½®æ–‡ä»¶
    cp config.py config_backup_$(date +%Y%m%d).py
    ```
    
    **2. æœåŠ¡é…ç½®å¤‡ä»½**
    
    ```bash
    # å¤‡ä»½Docker Composeé…ç½®
    docker compose -p mineru -f compose.yaml config > mineru_config_backup.yaml
    ```
    
    #### æ€§èƒ½ç›‘æ§
    
    **1. èµ„æºä½¿ç”¨ç›‘æ§**
    
    ```bash
    # æ£€æŸ¥Dockerå®¹å™¨èµ„æºä½¿ç”¨
    docker stats
    
    # æ£€æŸ¥GPUä½¿ç”¨æƒ…å†µï¼ˆMinerUæœåŠ¡å™¨ï¼‰
    nvidia-smi
    
    # æ£€æŸ¥ç£ç›˜ç©ºé—´
    df -h
    ```
    
    **2. æœåŠ¡å¥åº·æ£€æŸ¥è„šæœ¬**
    
    åˆ›å»ºå¥åº·æ£€æŸ¥è„šæœ¬`health_check.sh`ï¼š
    ```bash
    #!/bin/bash
    echo "=== æœåŠ¡å¥åº·æ£€æŸ¥ ==="
    
    echo "æ£€æŸ¥MinerUæœåŠ¡..."
    curl -s http://10.31.60.127:8000/health || echo "MinerUæœåŠ¡å¼‚å¸¸"
    
    echo "æ£€æŸ¥UnstructuredæœåŠ¡..."
    curl -s http://10.31.60.11:8000/health || echo "UnstructuredæœåŠ¡å¼‚å¸¸"
    
    echo "æ£€æŸ¥OllamaæœåŠ¡..."
    curl -s http://10.31.60.9:11434/api/tags || echo "OllamaæœåŠ¡å¼‚å¸¸"
    
    echo "=== æ£€æŸ¥å®Œæˆ ==="
    ```
    
    #### ç´§æ€¥æ¢å¤ç¨‹åº
    
    **1. å®Œå…¨æœåŠ¡é‡å¯**
    
    ```bash
    # åœ¨10.31.60.127ä¸Š
    docker compose -p mineru -f compose.yaml --profile api restart
    
    # åœ¨10.31.60.11ä¸Š  
    docker restart unstructured-api
    
    # åœ¨10.31.60.9ä¸Š
    systemctl restart ollama
    
    # åœ¨PQM_AIåº”ç”¨æœåŠ¡å™¨ä¸Š
    # é‡å¯Streamlitåº”ç”¨
    ```
    
    **2. æœåŠ¡é™çº§æ–¹æ¡ˆ**
    
    å¦‚æœæŸä¸ªæœåŠ¡ä¸å¯ç”¨ï¼Œå¯ä»¥ä¸´æ—¶ä¿®æ”¹é…ç½®ï¼š
    - ç¦ç”¨PDFå¤„ç†ï¼šæ³¨é‡Šæ‰MinerUç›¸å…³ä»£ç 
    - ç¦ç”¨Word/PPTå¤„ç†ï¼šæ³¨é‡Šæ‰Unstructuredç›¸å…³ä»£ç 
    - ä½¿ç”¨å¤‡ç”¨LLMï¼šä¿®æ”¹Ollamaé…ç½®æŒ‡å‘å…¶ä»–æœåŠ¡å™¨
    
    #### è”ç³»ä¿¡æ¯
    
    - **ä¸»è¦ç»´æŠ¤äººå‘˜**ï¼šå‘¨æ˜­å¤
    - **æœåŠ¡å™¨è®¿é—®**ï¼šéœ€è¦ç›¸åº”æœåŠ¡å™¨çš„SSHæƒé™
    - **ç´§æ€¥è”ç³»**ï¼šé€šè¿‡å†…éƒ¨é€šè®¯å·¥å…·è”ç³»æŠ€æœ¯å›¢é˜Ÿ
    
    #### ç›¸å…³æ–‡æ¡£é“¾æ¥
    
    - [MinerUå®˜æ–¹æ–‡æ¡£](https://opendatalab.github.io/MinerU/)
    - [MinerU Dockeréƒ¨ç½²æŒ‡å—](https://opendatalab.github.io/MinerU/quick_start/docker_deployment/)
    - [Unstructuredå®˜æ–¹æ–‡æ¡£](https://docs.unstructured.io/)
    - [Ollamaå®˜æ–¹æ–‡æ¡£](https://ollama.ai/docs)
    """)



